{"ts":1362361443303,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var lookup = {};\nlookup.lookup_airport_by_id = function(id){\n\t\tvar ap=false;\n\t\tengine.state_object.airports.forEach(function(a){\n\t\t\tif(a.id == id){\n\t\t\t\tap=a;\n\t\t\t\treturn;\n\t\t\t}\n\t\t});\n\t\treturn ap;\n\t};\n\tlookup.get_angle_to_rotate = function(rise, run){\n\t\t\n\t\tvar angle = (Math.atan(rise/run) *(180/ Math.PI));\n\t\tif(rise > 0){\n\t\t\treturn (angle -90) * -1;\n\t\t}else{\n\t\t\treturn (angle -270) * -1;\n\t\t}\n\t\t//return () - 90) * (rise < 0? 1 : -1);\n\t};\n\n\tlookup.lookup_plane_by_id = function(id){\n\t\tvar plane = false;\n\t\tengine.state_object.planes.forEach(function(p){\n\t\t\tif(p.id == id){\n\t\t\t\tplane = p;\n\t\t\t\treturn;\n\t\t\t}\n\t\t});\n\t\treturn plane;\n\t};\n\tlookup.lookup_job_by_id = function(id){\n\t\tvar job = false;\n\t\tengine.state_object.jobs.forEach(function(j){\n\t\t\tif(j.id == id){\n\t\t\t\tjob = j;\n\t\t\t\treturn;\n\t\t\t}\n\t\t});\n\t\treturn job;\n\t};\n\tlookup.lookup_estimate_plane_position = function(plane){\n\t\tvar progress_percent = (engine.gameTime - plane.takeoff_time) / (plane.arrives_at - plane.takeoff_time);\n\n\t\tvar beginPosition = plane.last_airport_object.position;\n\t\tvar endPosition = plane.next_airport_object.position;\n\t\tvar estPosition = {\"latitude\":beginPosition.latitude,\"longitude\":beginPosition.longitude};\n\t\testPosition.latitude += (endPosition.latitude - beginPosition.latitude) * progress_percent;\n\t\testPosition.longitude += (endPosition.longitude - beginPosition.longitude) * progress_percent;\n\t\treturn estPosition;\n\t};\n\tlookup.seconds_until_arrival = function(plane_id){\n\t\tvar plane = lookup.lookup_plane_by_id(plane_id);\n\t\tvar seconds_until_arrival = (plane.arrives_at - engine.gameTime)/1000;\n\t\treturn Math.round(seconds_until_arrival > 0 ? seconds_until_arrival : 0);\n\t};\n\tlookup.get_flight_time = function(flight_distance, plane){\n\t\treturn Math.round(((flight_distance / plane.speed)/ engine.state_object.plane_base_speed) / 1000);\n\t};\n\tlookup.get_flight_cost = function(flight_distance){\n\t\treturn Math.round(flight_distance * engine.state_object.flying_base_cost);\n\t};\n\tlookup.lookup_flight_retail_cost = function(flight_distance){\n\t\treturn Math.round(flight_distance * engine.state_object.flying_base_cost * 0.85);\n\t};\n\tlookup.get_distance = function(point1,point2){\n\t\tvar R = 6371; // km\n\t\tvar d = Math.acos(Math.sin(point1.latitude)*Math.sin(point2.latitude) +\n\t\t\t\t\t\tMath.cos(point1.latitude)*Math.cos(point2.latitude) *\n\t\t\t\t\t\tMath.cos(point2.longitude-point1.longitude)) * R;\n\t\treturn Math.round(d);\n\t};"]],"start1":0,"start2":0,"length1":0,"length2":2393}]],"length":2393}
